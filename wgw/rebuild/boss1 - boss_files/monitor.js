function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(r,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function _createClass(r,e,o){return e&&_defineProperties(r.prototype,e),o&&_defineProperties(r,o),r}function _defineProperty(r,e,o){return e in r?Object.defineProperty(r,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[e]=o,r}!function(){var r,e={MonitorId:{ADD_MODULE:7743,HIDE_MODULE:7744,COPY_MODULE:7745,REFRESH_MODULE:7747,SWITCH_STATUS:7873,SUBMIT_FORM:7748,TAB_CONTAINER_SWITCH:7749,FOLD_CONTAINER_SWUTCH:7750,OPEN_PANEL:7751,DESIGN_SAVE:7752,ADD_PAGE:7753,OPEN_RAPID_SITE:7754},AlarmMonitorId:{ADD_MODULE:7755,HIDE_MODULE:7756,COPY_MODULE:7757,REFRESH_MODULE:7758,SWITCH_STATUS:7875,SUBMIT_FORM:7759,TAB_CONTAINER_SWITCH:7760,FOLD_CONTAINER_SWUTCH:7761,OPEN_PANEL:7762,DESIGN_SAVE:7763,ADD_PAGE:7764,OPEN_RAPID_SITE:7766,JZ_UTILS:7767}},o=e.MonitorId,n=e.AlarmMonitorId;e._AutoAlarmMonitorMap=(_defineProperty(r={},o.ADD_MODULE,n.ADD_MODULE),_defineProperty(r,o.HIDE_MODULE,n.HIDE_MODULE),_defineProperty(r,o.COPY_MODULE,n.COPY_MODULE),_defineProperty(r,o.REFRESH_MODULE,n.REFRESH_MODULE),_defineProperty(r,o.FOLD_CONTAINER_SWUTCH,n.FOLD_CONTAINER_SWUTCH),_defineProperty(r,o.TAB_CONTAINER_SWITCH,n.TAB_CONTAINER_SWITCH),_defineProperty(r,o.OPEN_PANEL,n.OPEN_PANEL),_defineProperty(r,o.DESIGN_SAVE,n.DESIGN_SAVE),_defineProperty(r,o.ADD_PAGE,n.ADD_PAGE),_defineProperty(r,o.OPEN_RAPID_SITE,n.OPEN_RAPID_SITE),r);var t=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"startMonitor",value:function(e){var o=this;if(!e)return console.error("请传入 monitorId"),function(){};var n=new Date;return r._monitors[e]={startTime:n},function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return o.endMonitor(e,r)}}},{key:"endMonitor",value:function(e){var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=r._monitors[e];delete r._monitors[e],n&&n.startTime&&this.logMonitor(e,!o,new Date-n.startTime)}},{key:"logMonitor",value:function(r,e,o){this._sendData({monitorId:r,cmd:"logMonitor",isError:e,consumeTime:o,alarmMonitorId:this._getAutoAlarmMonitorId(r)})}},{key:"logAlarmMonitor",value:function(r){this._sendData({monitorId:r,cmd:"logAlarmMonitor"})}},{key:"_sendData",value:function(r){location.search.includes("monitor_log")&&console.log("监控上报",r);var e=null;if("undefined"!=typeof jQuery)e=jQuery;else{if("undefined"==typeof jm)return;e=jm}e.ajax({url:"/ajax/frontMonitor_h.jsp",type:"post",data:r,success:function(r){var e=JSON.parse(r);e.success||console.error("监控数据上报错误",e)},error:function(r){console.error("监控数据上报错误",r)}})}},{key:"_getAutoAlarmMonitorId",value:function(r){return e._AutoAlarmMonitorMap[r]||0}},{key:"monitorDecorator",value:function(e){return function(o){return function(){var n,t=r.startMonitor(o);try{n=e.apply(this,arguments)}catch(r){throw t(!1),r}return n instanceof Promise?n.then(function(r){return t(!0),r}).catch(function(r){throw t(!1),r}):(t(!0),n)}}}}]),r}();t._monitors={},window.Monitor=t,window.MonitorDef=e,Function.prototype.bindMonitor=function(r){return t.monitorDecorator(this)(r)}}();